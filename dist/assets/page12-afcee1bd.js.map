{"version":3,"file":"page12-afcee1bd.js","sources":["../../src/shaders/galaxy/vertex.glsl","../../src/shaders/galaxy/fragment.glsl","../../src/act2/script4.js"],"sourcesContent":["uniform float uSize;\r\nuniform float uTime;\r\nattribute vec3 aRandomness;\r\nvarying vec3 vColor;\r\n\r\nvoid main() {\r\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\r\n\r\n    float angle = atan(modelPosition.x, modelPosition.z);\r\n    float distanceToCenter = length(modelPosition.xz);\r\n    float angleOffset = (1.0 / distanceToCenter) * uTime * 0.2;\r\n    angle += angleOffset;\r\n\r\n    modelPosition.x = cos(angle) * distanceToCenter;\r\n    modelPosition.z = sin(angle) * distanceToCenter;\r\n\r\n    modelPosition.xyz += aRandomness;\r\n\r\n    vec4 viewPosition = viewMatrix * modelPosition;\r\n    vec4 projectedPosition = projectionMatrix * viewPosition;\r\n\r\n    gl_Position = projectedPosition;\r\n    gl_PointSize = uSize * (1.0 / -viewPosition.z);\r\n    vColor = color;\r\n}\r\n","varying vec3 vColor;\r\n\r\nvoid main() {\r\n    float strength = distance(gl_PointCoord, vec2(0.5));\r\n    strength = 1.0 - strength;\r\n    strength = pow(strength, 10.0);\r\n\r\n    vec3 color = mix(vec3(0.0), vColor, strength);\r\n    gl_FragColor = vec4(color, 1.0);\r\n}\r\n","import * as three from 'three'\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\r\nimport * as lilGUI from 'lil-gui'\r\nimport galaxyVertexShader from '/shaders/galaxy/vertex.glsl'\r\nimport galaxyFragmentShader from '/shaders/galaxy/fragment.glsl'\r\n\r\nconst canvas = document.querySelector('canvas.webgl');\r\nconst scene = new three.Scene();\r\nconst gui = new lilGUI.GUI()\r\n\r\nconst sizes =\r\n{\r\n  width: window.innerWidth,\r\n  height: window.innerHeight\r\n}\r\n\r\nconst param = {}\r\nparam.count = 4500\r\nparam.size = 0.02\r\nparam.radius = 3.8\r\nparam.branches = 3\r\n// param.spin = 1\r\nparam.randomness = 0.25\r\nparam.randomnessPow = 1\r\nparam.insideColor = '#c91870'\r\nparam.outsideColor = '#1b3984'\r\n\r\n\r\n// Optionally, adjust ambient light if necessary\r\nconst ambientLight = new three.AmbientLight('#555555', 0.5); // Soft light to illuminate everything slightly\r\nscene.add(ambientLight);\r\n\r\nlet sphere = null\r\nlet pointLight = null\r\n\r\nconst geometry = new three.BufferGeometry()\r\nconst colors = new Float32Array(param.count * 3)\r\nconst scales = new Float32Array(param.count * 1)\r\n\r\n\r\nconst renderer = new three.WebGLRenderer\r\n({\r\n  canvas: canvas\r\n});\r\n\r\nconst mats = new three.ShaderMaterial({\r\n  depthWrite: false,\r\n  blending: three.AdditiveBlending,\r\n  vertexColors: true,\r\n  vertexShader: galaxyVertexShader,\r\n  fragmentShader: galaxyFragmentShader,\r\n  uniforms:\r\n  {\r\n    uSize: { value:30 * renderer.getPixelRatio() },\r\n    uTime: { value: 0 }\r\n  },\r\n})\r\nconst points = new three.Points(geometry, mats)\r\n\r\nconst genGalaxy = () =>\r\n{ \r\n  if(points !== null)\r\n  {\r\n    geometry.dispose()\r\n    mats.dispose()\r\n    scene.remove(points)\r\n  }\r\n\r\n  if (sphere) {\r\n    sphere.geometry.dispose();\r\n    sphere.material.dispose();\r\n    scene.remove(sphere);\r\n  }\r\n\r\n  const pos = new Float32Array(param.count * 3)\r\n  const colorInside = new three.Color(param.insideColor)\r\n  const colorOutside = new three.Color(param.outsideColor)\r\n  \r\n  geometry.setAttribute('position', new three.BufferAttribute(pos, 3))\r\n  geometry.setAttribute('color', new three.BufferAttribute(colors, 3))\r\n  geometry.setAttribute('aScale', new three.BufferAttribute(scales, 1))\r\n\r\n  for(let i = 0; i < param.count; i++)\r\n  {\r\n    const i3 = i * 3\r\n    const radius = Math.random() * param.radius\r\n    const branchAngle = (i % param.branches) / param.branches * Math.PI * 2\r\n    // const spinAngle = radius * param.spin\r\n    const randomX = Math.pow(Math.random(), param.randomnessPow) * (Math.random() < 0.5 ? 1 : - 1) * param.randomness * radius\r\n    const randomY = Math.pow(Math.random(), param.randomnessPow) * (Math.random() < 0.5 ? 1 : - 1) * param.randomness * radius\r\n    const randomZ = Math.pow(Math.random(), param.randomnessPow) * (Math.random() < 0.5 ? 1 : - 1) * param.randomness * radius\r\n\r\n    pos[i3 ] = Math.cos(branchAngle) * radius + randomX // for x\r\n    pos[i3 + 1] = randomY // for y\r\n    pos[i3 + 2] = Math.sin(branchAngle) * radius + randomZ // for z\r\n\r\n    const mixedColor = colorInside.clone()\r\n    mixedColor.lerp(colorOutside, radius / param.radius)\r\n    colors[i3 ] = mixedColor.r\r\n    colors[i3 + 1] = mixedColor.g\r\n    colors[i3 + 2] = mixedColor.b\r\n    scales[i] = Math.random()\r\n  }\r\n  scene.add(points)\r\n\r\n  const sphereGeometry = new three.SphereGeometry(0.05,64,64);\r\n  const sphereMaterial = new three.MeshStandardMaterial({\r\n    color: param.insideColor,\r\n    emissive: param.insideColor,\r\n    emissiveIntensity: 0.8,\r\n    roughness: 0.5,\r\n    metalness: 0.3,\r\n  });\r\n  sphere = new three.Mesh(sphereGeometry, sphereMaterial);\r\n  scene.add(sphere);\r\n\r\n  if (!pointLight) {\r\n    pointLight = new three.PointLight(param.insideColor, 1, 50);\r\n    pointLight.position.set(0, 0, 0);\r\n    scene.add(pointLight);\r\n  } else {\r\n    pointLight.color.set(param.insideColor);\r\n  }\r\n}\r\n\r\ngenGalaxy()\r\n\r\ngui.add(param, 'count').min(100).max(1000000).step(100).onFinishChange(genGalaxy)\r\ngui.add(param, 'size').min(0.001).max(0.1).step(0.001).onFinishChange(genGalaxy)\r\ngui.add(param, 'radius').min(0.01).max(20).step(0.01).onFinishChange(genGalaxy)\r\ngui.add(param,'branches').min(2).max(20).step(1).onFinishChange(genGalaxy)\r\n// gui.add(param, 'spin').min(-5).max(5).step(0.001).onFinishChange(genGalaxy)\r\ngui.add(param,  'randomness').min(0).max(2).step(0.001).onFinishChange(genGalaxy)\r\ngui.add(param, 'randomnessPow').min(1).max(10).step(0.001).onFinishChange(genGalaxy)\r\ngui.addColor(param, 'insideColor').onFinishChange(genGalaxy)\r\ngui.addColor(param, 'outsideColor').onFinishChange(genGalaxy)\r\n\r\nconst cam = new three.PerspectiveCamera(75, sizes.width / sizes.height);\r\ncam.position.y = 3.5\r\ncam.position.z = 4\r\nscene.add(cam);\r\nconst control = new OrbitControls(cam, canvas);\r\ncontrol.enableDamping = true;\r\n\r\nwindow.addEventListener('resize', () =>\r\n{\r\n  sizes.width = window.innerWidth;\r\n  sizes.height = window.innerHeight;\r\n  cam.aspect = sizes.width / sizes.height;\r\n  renderer.setSize(sizes.width, sizes.height);\r\n  \r\n  cam.updateProjectionMatrix();\r\n}) \r\n\r\nwindow.addEventListener('dblclick', () =>\r\n{\r\n  const fullscreenElement = document.fullscreenElement || document.webkitFullscreenElement\r\n\r\n  if(!fullscreenElement)\r\n  {\r\n    if(canvas.requestFullscreen)\r\n    {\r\n      canvas.requestFullscreen();\r\n    }\r\n    else if(canvas.webkitFullscreenElement)\r\n    {\r\n      canvas.webkitFullscreenElement();\r\n    }\r\n  }\r\n  else\r\n  {\r\n    if(document.exitFullscreen)\r\n    {\r\n      document.exitFullscreen();\r\n    }\r\n    else if(document.webkitFullscreenElement)\r\n    {\r\n      document.webkitFullscreenElement();\r\n    }\r\n  }\r\n})\r\n\r\n\r\n\r\nrenderer.setSize(sizes.width, sizes.height);\r\nrenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))\r\nrenderer.render(scene,cam);\r\n\r\nconst clock = new three.Clock();\r\nconst tick = () =>\r\n{\r\n  const elapsedTime = clock.getElapsedTime()\r\n  mats.uniforms.uTime.value = elapsedTime\r\n  control.update();\r\n  renderer.render(scene, cam);\r\n  window.requestAnimationFrame(tick);\r\n}\r\n\r\ntick();"],"names":["vertex_default","fragment_default","canvas","scene","three.Scene","gui","lilGUI.GUI","sizes","param","ambientLight","three.AmbientLight","sphere","pointLight","geometry","three.BufferGeometry","colors","scales","renderer","three.WebGLRenderer","mats","three.ShaderMaterial","three.AdditiveBlending","galaxyVertexShader","galaxyFragmentShader","points","three.Points","genGalaxy","pos","colorInside","three.Color","colorOutside","three.BufferAttribute","i","i3","radius","branchAngle","randomX","randomY","randomZ","mixedColor","sphereGeometry","three.SphereGeometry","sphereMaterial","three.MeshStandardMaterial","three.Mesh","three.PointLight","cam","three.PerspectiveCamera","control","OrbitControls","clock","three.Clock","tick","elapsedTime"],"mappings":"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"}